var loader,__bind=function(t,e){return function(){return t.apply(e,arguments)}};(loader=function(t){return function(t,e){return"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.Tutorialize=e(t.jQuery)}}(this))(this,function(t){return function(e){var n;return n=function(){function n(n,i){t.prev=__bind(t.prev,this),t.next=__bind(t.next,this),t.closeOnKeyDown=__bind(t.closeOnKeyDown,this),t.changePageOnKeyDown=__bind(t.changePageOnKeyDown,this),t.showPanelAtIndex=__bind(t.showPanelAtIndex,this),t.showPanel=__bind(t.showPanel,this),t.updateCounter=__bind(t.updateCounter,this),t.end=__bind(t.end,this),t.start=__bind(t.start,this);var o;o={interactive:!1,arrows:{weight:1,color:"white",distance:80},backdrop:!0,closable:!0,annotationPadding:10,counter:!0},this.tutorial=n,this.options=e.extend(!0,o,i),this.currentIndex=-1,this.container=null,this.backdrop=null,this.canvas=null,this.counter=null}return n.prototype.start=function(){return this.options.backdrop&&(this.backdrop=e("<div/>",{"class":"tutorial-backdrop",css:{background:"rgba(0, 0, 0, 0.8)"}}).appendTo(e("body"))),this.container=e("<div/>",{"class":"tutorial-container"}).appendTo(e("body")),this.options.counter&&(this.counter=e("<div/>",{"class":"tutorial-panel-counter"}).appendTo(this.container)),this.options.interactive&&(this.container.click(this.next),e(document).keydown(this.changePageOnKeyDown)),this.options.closable&&!this.options.interactive&&this.container.click(this.end),this.options.closable&&(this.container.append(e("<a/>",{"class":"tutorial-close",html:"&#10006;"}).click(this.end)),e(document).keydown(this.closeOnKeyDown)),this.canvas=e("<canvas/>",{"class":"tutorial-canvas"}).appendTo(this.container).attr("width",this.container.width()).attr("height",this.container.height())[0],this.showPanelAtIndex(0)},n.prototype.end=function(){var t;return this.container.off("click",this.next),e(document).off("keydown",this.changePageOnKeyDown),e(document).off("keydown",this.closeOnKeyDown),this.container.remove(),null!=(t=this.backdrop)&&t.remove(),e(this.canvas).remove(),e("body").find(".tutorial-show-element").removeClass("tutorial-show-element"),this.currentIndex=-1,this.container=null,this.canvas=null},n.prototype.updateCounter=function(){var t;return null!=(t=this.counter)?t.text(""+(this.currentIndex+1)+" / "+this.tutorial.length):void 0},n.prototype.showPanel=function(t){var n,i,o,s,r,a,h,c,d,l,u,p,w,f,v,g,y;for(this.container.find(".tutorial-message, .tutorial-annotation").remove(),e("body").find(".tutorial-show-element").removeClass("tutorial-show-element"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),y=[],f=0,v=t.length;v>f;f++){switch(n=t[f],i=e("<div/>",{"class":"tutorial-annotation"}).append(e("<p/>",{"class":"tutorial-annotation-text",html:n.text})).appendTo(this.container),w=e(n.selector),w.addClass("tutorial-show-element"),e.type("object"===n.arrow)?(a={},e.extend(a,this.options.arrows,n.arrow)):a=this.options.arrows,o=null!=(g=n.padding)?g:this.options.annotationPadding,p=w.offset(),n.position){case"top":s=p.left+w.width()/2-i.width()/2,r=p.top-a.distance,h=s+i.width()/2,d=r+i.height()+o;break;case"bottom":s=p.left+w.width()/2-i.width()/2,r=p.top+w.height()+a.distance,h=s+i.width()/2,d=r-o;break;case"left":s=p.left-a.distance,r=p.top+w.height()/2-i.height()/2,h=s+i.width()+o,d=r+i.height()/2;break;case"right":s=p.left+w.width()+a.distance,r=p.top+w.height()/2-i.height()/2,h=s-o,d=r+i.height()/2}i.css("left",s),i.css("top",r),n.arrow?(u=this.canvas.getContext("2d"),u.save(),u.strokeStyle=a.color,u.lineWidth=a.weight,u.beginPath(),u.moveTo(h,d),c=p.left+w.width()/2,l=p.top+w.height()/2,u.lineTo(c,l),u.stroke(),u.closePath(),y.push(u.restore())):y.push(void 0)}return y},n.prototype.showPanelAtIndex=function(t){return this.currentIndex=t,this.showPanel(this.tutorial[t]),this.updateCounter()},n.prototype.changePageOnKeyDown=function(t){switch(t.which){case 37:return this.prev();case 39:return this.next()}},n.prototype.closeOnKeyDown=function(t){return 27===t.which?this.end():void 0},n.prototype.next=function(){var t;return-1<(t=this.currentIndex)&&t<this.tutorial.length-1?this.showPanelAtIndex(this.currentIndex+1):this.end()},n.prototype.prev=function(){var t;return this.tutorial.length>(t=this.currentIndex)&&t>0?this.showPanelAtIndex(this.currentIndex-1):void 0},n}()}}(this));