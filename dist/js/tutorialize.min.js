(function(){var t,n=function(t,n){return function(){return t.apply(n,arguments)}};t=function(){function t(t,e){this.prev=n(this.prev,this),this.next=n(this.next,this),this.onLastPanel=n(this.onLastPanel,this),this.onFirstPanel=n(this.onFirstPanel,this),this.showPanelAtIndex=n(this.showPanelAtIndex,this),this.showPanel=n(this.showPanel,this),this.end=n(this.end,this),this.start=n(this.start,this);var i;i={tutorial:[],interactive:!1,arrows:{weight:1,color:"white",distance:80},backdrop:!0,closable:!0,annotationPadding:10},this.tutorial=t,this.options=$.extend(!0,i,e),this.currentIndex=-1,this.container=null,this.canvas=null}return t.prototype.start=function(){var t;return t=this.options.backdrop?"rgba(0, 0, 0, 0.8)":"none",this.container=$("<div/>",{"class":"tutorial-backdrop",css:{background:t}}).appendTo($("body")),this.options.closable&&!this.options.interactive&&this.container.click(this.end),this.options.closable&&this.container.append($("<a/>",{"class":"tutorial-close",html:"&#10006;"}).click(this.end)),this.canvas=$("<canvas/>",{"class":"tutorial-canvas"}).appendTo(this.container).attr("width",this.container.width()).attr("height",this.container.height())[0],this.showPanelAtIndex(0)},t.prototype.end=function(){return this.container.remove(),$(this.canvas).remove(),$("body").find(".tutorial-show-element").removeClass("tutorial-show-element"),this.currentIndex=-1,this.container=null,this.canvas=null},t.prototype.showPanel=function(t){var n,e,i,s,o,a,h,r,l,c,d,u,p,w,v,f,g,x;for(this.container.find(".tutorial-message, .tutorial-annotation").remove(),$("body").find(".tutorial-show-element").removeClass("tutorial-show-element"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.options.interactive&&(this.container.click(this.next),$(document).keydown(function(t){return function(n){switch(n.which){case 37:return t.prev();case 39:return t.next()}}}(this))),f=t.annotations,x=[],w=0,v=f.length;v>w;w++){switch(n=f[w],e=$("<div/>",{"class":"tutorial-annotation"}).append($("<p/>",{"class":"tutorial-annotation-text",html:n.text})).appendTo(this.container),p=$(n.selector),p.addClass("tutorial-show-element"),$.type("object"===n.arrow)?(a={},$.extend(a,this.options.arrows,n.arrow)):a=this.options.arrows,i=null!=(g=n.padding)?g:this.options.annotationPadding,u=p.offset(),n.position){case"top":s=u.left+p.width()/2-e.width()/2,o=u.top-a.distance,h=s+e.width()/2,l=o+e.height()+i;break;case"bottom":s=u.left+p.width()/2-e.width()/2,o=u.top+p.height()+a.distance,h=s+e.width()/2,l=o-i;break;case"left":s=u.left-a.distance,o=u.top+p.height()/2-e.height()/2,h=s+e.width()+i,l=o+e.height()/2;break;case"right":s=u.left+p.width()+a.distance,o=u.top+p.height()/2-e.height()/2,h=s-i,l=o+e.height()/2}e.css("left",s),e.css("top",o),n.arrow?(d=this.canvas.getContext("2d"),d.save(),d.strokeStyle=a.color,d.lineWidth=a.weight,d.beginPath(),d.moveTo(h,l),r=u.left+p.width()/2,c=u.top+p.height()/2,d.lineTo(r,c),d.stroke(),d.closePath(),x.push(d.restore())):x.push(void 0)}return x},t.prototype.showPanelAtIndex=function(t){return this.currentIndex=t,this.showPanel(this.tutorial[t])},t.prototype.onFirstPanel=function(){return 0===this.currentIndex},t.prototype.onLastPanel=function(){return this.currentIndex===this.tutorial.length-1},t.prototype.next=function(){return this.onLastPanel()?this.end():this.showPanelAtIndex(this.currentIndex+1)},t.prototype.prev=function(){return this.onFirstPanel()?void 0:this.showPanelAtIndex(this.currentIndex-1)},t}(),function(n){return n.tutorialize=function(n){var e;return null==n&&(n={}),e=n.tutorial,delete n.tutorial,new t(e,n)}}(jQuery)}).call(this);