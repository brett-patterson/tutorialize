var loader,__bind=function(t,e){return function(){return t.apply(e,arguments)}};(loader=function(t,e){return"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.Tutorialize=e(t.jQuery)})(this,function(t){var e;return e=function(){function e(e,n){this.prev=__bind(this.prev,this),this.next=__bind(this.next,this),this.closeOnKeyDown=__bind(this.closeOnKeyDown,this),this.changePageOnKeyDown=__bind(this.changePageOnKeyDown,this),this.showPanelAtIndex=__bind(this.showPanelAtIndex,this),this.showPanel=__bind(this.showPanel,this),this.updateCounter=__bind(this.updateCounter,this),this.end=__bind(this.end,this),this.start=__bind(this.start,this);var i;i={interactive:!1,arrows:{weight:1,color:"white",distance:80},backdrop:!0,closable:!0,annotationPadding:10,counter:!0},this.tutorial=e,this.options=t.extend(!0,i,n),this.currentIndex=-1,this.container=null,this.backdrop=null,this.canvas=null,this.counter=null}return e.prototype.start=function(){return this.options.backdrop&&(this.backdrop=t("<div/>",{"class":"tutorial-backdrop"}).appendTo(t("body"))),this.container=t("<div/>",{"class":"tutorial-container"}).appendTo(t("body")),this.options.counter&&(this.counter=t("<div/>",{"class":"tutorial-panel-counter"}).appendTo(this.container)),this.options.interactive&&(this.container.click(this.next),t(document).keydown(this.changePageOnKeyDown)),this.options.closable&&!this.options.interactive&&this.container.click(this.end),this.options.closable&&(this.container.append(t("<a/>",{"class":"tutorial-close",html:"&#10006;"}).click(this.end)),t(document).keydown(this.closeOnKeyDown)),this.canvas=t("<canvas/>",{"class":"tutorial-canvas"}).appendTo(this.container).attr("width",this.container.width()).attr("height",this.container.height())[0],this.showPanelAtIndex(0)},e.prototype.end=function(){var e;return this.container.off("click",this.next),t(document).off("keydown",this.changePageOnKeyDown),t(document).off("keydown",this.closeOnKeyDown),this.container.remove(),null!=(e=this.backdrop)&&e.remove(),t(this.canvas).remove(),t("body").find(".tutorial-show-element").removeClass("tutorial-show-element"),this.currentIndex=-1,this.container=null,this.canvas=null},e.prototype.updateCounter=function(){var t;return null!=(t=this.counter)?t.text(""+(this.currentIndex+1)+" / "+this.tutorial.length):void 0},e.prototype.showPanel=function(e){var n,i,o,s,h,a,r,c,d,l,u,p,w,v,f,g,y;for(this.container.find(".tutorial-message, .tutorial-annotation").remove(),t("body").find(".tutorial-show-element").removeClass("tutorial-show-element"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),y=[],v=0,f=e.length;f>v;v++){switch(n=e[v],i=t("<div/>",{"class":"tutorial-annotation"}).append(t("<p/>",{"class":"tutorial-annotation-text",html:n.text})).appendTo(this.container),w=t(n.selector),w.addClass("tutorial-show-element"),n.noBackground||w.addClass("tutorial-show-element-background"),t.type("object"===n.arrow)?(a={},t.extend(a,this.options.arrows,n.arrow)):a=this.options.arrows,o=null!=(g=n.padding)?g:this.options.annotationPadding,p=w.offset(),n.position){case"top":s=p.left+w.width()/2-i.width()/2,h=p.top-a.distance,r=s+i.width()/2,d=h+i.height()+o;break;case"bottom":s=p.left+w.width()/2-i.width()/2,h=p.top+w.height()+a.distance,r=s+i.width()/2,d=h-o;break;case"left":s=p.left-a.distance,h=p.top+w.height()/2-i.height()/2,r=s+i.width()+o,d=h+i.height()/2;break;case"right":s=p.left+w.width()+a.distance,h=p.top+w.height()/2-i.height()/2,r=s-o,d=h+i.height()/2}i.css("left",s),i.css("top",h),n.arrow?(u=this.canvas.getContext("2d"),u.save(),u.strokeStyle=a.color,u.lineWidth=a.weight,u.beginPath(),u.moveTo(r,d),c=p.left+w.width()/2,l=p.top+w.height()/2,u.lineTo(c,l),u.stroke(),u.closePath(),y.push(u.restore())):y.push(void 0)}return y},e.prototype.showPanelAtIndex=function(t){return this.currentIndex=t,this.showPanel(this.tutorial[t]),this.updateCounter()},e.prototype.changePageOnKeyDown=function(t){switch(t.which){case 37:return this.prev();case 39:return this.next()}},e.prototype.closeOnKeyDown=function(t){return 27===t.which?this.end():void 0},e.prototype.next=function(){var t;return-1<(t=this.currentIndex)&&t<this.tutorial.length-1?this.showPanelAtIndex(this.currentIndex+1):this.end()},e.prototype.prev=function(){var t;return this.tutorial.length>(t=this.currentIndex)&&t>0?this.showPanelAtIndex(this.currentIndex-1):void 0},e}()});