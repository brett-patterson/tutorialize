(function(){var t,n=function(t,n){return function(){return t.apply(n,arguments)}};t=function(){function t(t,i){this.next=n(this.next,this),this.onLastPanel=n(this.onLastPanel,this),this.showPanelAtIndex=n(this.showPanelAtIndex,this),this.showPanel=n(this.showPanel,this),this.end=n(this.end,this),this.start=n(this.start,this);var e;e={tutorial:[],interactive:!1,arrows:{weight:6,color:"white"},backdrop:!0,closeOnBackgroundClick:!1,closable:!0},this.tutorial=t,this.options=$.extend(!0,e,i),this.currentIndex=-1,this.container=null,this.canvas=null}return t.prototype.start=function(){var t;return t=this.options.backdrop?"rgba(0, 0, 0, 0.5)":"none",this.container=$("<div/>",{"class":"tutorial-backdrop",css:{background:t}}).appendTo($("body")),this.options.closable&&this.options.closeOnBackgroundClick&&this.container.click(this.end),this.options.closable&&this.container.append($("<a/>",{"class":"tutorial-close",html:"&#10006;"}).click(this.end)),this.canvas=$("<canvas/>",{"class":"tutorial-canvas"}).appendTo(this.container).attr("width",this.container.width()).attr("height",this.container.height())[0],this.showPanelAtIndex(0)},t.prototype.end=function(){return this.container.remove(),$(this.canvas).remove(),this.currentIndex=-1,this.container=null,this.canvas=null},t.prototype.showPanel=function(t){var n,i,e,s,o,a,r,h,l,c,u,d,p,v,f,g,x,w,P;for(this.container.find(".tutorial-message, .tutorial-annotation").remove(),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.options.interactive&&(v=$("<div/>",{"class":"tutorial-message",html:"<div class='tutorial-message-title'>"+t.title+"</div>\n<div class='tutorial-message-text'>"+t.text+"</div>"}).appendTo(this.container).append($("<button/>",{"class":"tutorial-message-next",text:this.onLastPanel()?"Finish":"Next"}).click(this.next)),v.css("margin-left",v.width()/-2)),w=t.annotations,P=[],g=0,x=w.length;x>g;g++)i=w[g],s=i.position.x,o=i.position.y,e=$("<div/>",{"class":"tutorial-annotation",css:{left:s,top:o}}).append($("<p/>",{"class":"tutorial-annotation-text",html:i.text})).appendTo(this.container),i.arrow?(d=$(i.selector),P.push(function(){var t,i,v;for(v=[],t=0,i=d.length;i>t;t++)u=d[t],u=$(u),c=this.canvas.getContext("2d"),c.save(),c.beginPath(),a=s+e.outerWidth()/2,h=o+e.outerHeight()/2,c.moveTo(a,h),r=u.offset().left+u.width()/2,l=u.offset().top+u.height()/2,c.lineTo(r,l),c.strokeStyle=this.options.arrows.color,c.lineWidth=this.options.arrows.weight,c.stroke(),c.closePath(),f=(l-h)/(r-a),n=Math.atan(f),p=r>a?90:-90,n+=p*Math.PI/180,c.beginPath(),c.translate(r,l),c.rotate(n),c.moveTo(0,-10),c.lineTo(8,8),c.lineTo(-8,8),c.fillStyle=this.options.arrows.color,c.fill(),c.closePath(),v.push(c.restore());return v}.call(this))):P.push(void 0);return P},t.prototype.showPanelAtIndex=function(t){return this.currentIndex=t,this.showPanel(this.tutorial[t])},t.prototype.onLastPanel=function(){return this.currentIndex===this.tutorial.length-1},t.prototype.next=function(){return this.onLastPanel()?this.end():this.showPanelAtIndex(this.currentIndex+1)},t}(),function(n){return n.tutorialize=function(n){var i;return null==n&&(n={}),i=n.tutorial,delete n.tutorial,new t(i,n)}}(jQuery)}).call(this);